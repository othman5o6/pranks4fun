<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ†Ø² Ø§Ù„Ø¶Ø§Ø¦Ø¹</title>
  <style>
    body {
      font-family: 'Tahoma', sans-serif;
      background-color: #fdf6e3;
      text-align: center;
      margin: 20px;
    }

    .grid-wrapper {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
    }

    #grid {
      display: grid;
      grid-template-columns: repeat(5, 60px);
      grid-gap: 5px;
    }

    .cell {
      width: 60px;
      height: 60px;
      background-color: #eee;
      border: 1px solid #ccc;
      cursor: pointer;
      font-size: 18px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .found {
      background-color: gold !important;
      font-weight: bold;
    }

    .near {
      background-color: red;
      color: white;
    }

    .close {
      background-color: orange;
      color: white;
    }

    .far {
      background-color: lightblue;
    }

    .very-far {
      background-color: #ccc;
    }

    #message {
      font-size: 18px;
      margin-bottom: 10px;
    }

    #rules {
      font-size: 16px;
      text-align: right;
      max-width: 500px;
      margin: auto;
    }

    #rules li {
      margin-bottom: 10px;
    }

    button {
      margin: 10px;
      padding: 10px 20px;
      font-size: 16px;
    }

    #confetti {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 999;
    }

    @media (max-width: 600px) {
      .cell {
        width: 40px;
        height: 40px;
        font-size: 14px;
      }

      h1 {
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <h1>Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ†Ø² Ø§Ù„Ø¶Ø§Ø¦Ø¹</h1>
  <div id="attemptCounter">Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª: <span id="attempts">0</span> / <span id="maxAttempts">5</span></div>
  <div id="message"></div>
  <button onclick="init()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨</button>

  <div class="grid-wrapper">
    <div id="grid"></div>
  </div>

  <canvas id="confetti"></canvas>

  <div id="rules">
    <h3>ğŸ“œ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù„Ø¹Ø¨Ø©:</h3>
    <ul>
      <li>ğŸª™ Ù‡Ù†Ø§Ùƒ Ø®Ù„ÙŠØ© ÙˆØ§Ø­Ø¯Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ†Ø²</li>
      <li>ğŸ§  Ù„Ø¯ÙŠÙƒ 5 Ù…Ø­Ø§ÙˆÙ„Ø§Øª ÙÙ‚Ø· Ù„Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„ÙŠÙ‡</li>
      <li>ğŸ“ Ø§Ù„ØªÙ„Ù…ÙŠØ­Ø§Øª Ø¨Ø§Ù„Ø£Ù„ÙˆØ§Ù†:
        <ul>
          <li style="color:red;">Ø£Ø­Ù…Ø±: Ù‚Ø±ÙŠØ¨ Ø¬Ø¯Ù‹Ø§</li>
          <li style="color:orange;">Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ: Ù‚Ø±ÙŠØ¨</li>
          <li style="color:blue;">Ø£Ø²Ø±Ù‚: Ø¨Ø¹ÙŠØ¯</li>
          <li style="color:gray;">Ø±Ù…Ø§Ø¯ÙŠ: Ø¨Ø¹ÙŠØ¯ Ø¬Ø¯Ù‹Ø§</li>
        </ul>
      </li>
    </ul>
  </div>

  <script>
    const gridSize = 5;
    const maxAttempts = 5;
    let attempts = 0;
    let treasureRow, treasureCol;

    function init() {
      const grid = document.getElementById("grid");
      grid.innerHTML = "";
      document.getElementById("message").textContent = "";
      document.getElementById("attempts").textContent = "0";
      attempts = 0;

      treasureRow = Math.floor(Math.random() * gridSize);
      treasureCol = Math.floor(Math.random() * gridSize);

      for (let row = 0; row < gridSize; row++) {
        for (let col = 0; col < gridSize; col++) {
          const cell = document.createElement("div");
          cell.classList.add("cell");
          cell.addEventListener("click", () => handleClick(row, col, cell));
          grid.appendChild(cell);
        }
      }

      clearConfetti();
    }

    function handleClick(row, col, cell) {
      if (cell.classList.contains("found") || attempts >= maxAttempts) return;

      attempts++;
      document.getElementById("attempts").textContent = attempts;

      if (row === treasureRow && col === treasureCol) {
        cell.textContent = "ğŸ’°";
        cell.classList.add("found");
        document.getElementById("message").textContent = "ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ! Ù„Ù‚Ø¯ ÙØ²Øª Ø¨Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£ÙˆÙ„!";
        launchConfetti();
      } else {
        const distance = Math.abs(treasureRow - row) + Math.abs(treasureCol - col);
        if (distance === 1) {
          cell.classList.add("near");
        } else if (distance === 2) {
          cell.classList.add("close");
        } else if (distance <= 3) {
          cell.classList.add("far");
        } else {
          cell.classList.add("very-far");
        }

        if (attempts >= maxAttempts) {
          document.getElementById("message").textContent = "Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª! Ø§Ù„ÙƒÙ†Ø² ÙƒØ§Ù† ÙÙŠ (" + (treasureRow+1) + ", " + (treasureCol+1) + ")";
        }
      }
    }

    // Confetti animation
    function launchConfetti() {
      const canvas = document.getElementById("confetti");
      const ctx = canvas.getContext("2d");
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      let pieces = [];
      const numPieces = 150;

      for (let i = 0; i < numPieces; i++) {
        pieces.push({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height - canvas.height,
          color: `hsl(${Math.random() * 360}, 100%, 50%)`,
          size: Math.random() * 8 + 2,
          speed: Math.random() * 3 + 2,
          angle: Math.random() * 2 * Math.PI
        });
      }

      function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (let p of pieces) {
          ctx.fillStyle = p.color;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.size, 0, 2 * Math.PI);
          ctx.fill();
          p.y += p.speed;
          if (p.y > canvas.height) p.y = 0;
        }
        requestAnimationFrame(draw);
      }
      draw();
    }

    function clearConfetti() {
      const canvas = document.getElementById("confetti");
      const ctx = canvas.getContext("2d");
      ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

    // Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§
    window.onload = init;
  </script>
</body>
</html>
